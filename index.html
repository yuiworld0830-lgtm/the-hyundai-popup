<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>더현대 서울 팝업 라이브</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: sans-serif; background-color: #f8f9fa; }
        .carousel { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .carousel::-webkit-scrollbar { display: none; }
        .card { flex: 0 0 85%; scroll-snap-align: center; margin-right: 15px; background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .tag-live { background: #ef4444; color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; }
        .active-floor { border-bottom: 3px solid #059669; color: #059669 !important; }
    </style>
</head>
<body class="pb-20">

    <header class="p-6 bg-white sticky top-0 z-20 shadow-sm">
        <h1 class="text-xl font-black italic">THE HYUNDAI <span class="text-emerald-600 font-black">POP-UP</span></h1>
    </header>

    <main id="app" class="p-4 space-y-10">
        <div id="loading" class="text-center py-20 text-gray-400">데이터를 연결 중입니다...</div>
    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around items-center h-16 z-30">
        <a href="#B2" class="floor-link text-gray-400 font-bold">B2</a>
        <a href="#1F" class="floor-link text-gray-400 font-bold">1F</a>
        <a href="#5F" class="floor-link text-gray-400 font-bold">5F</a>
    </nav>

    <script>
        // 엑셀 주소 강제 변환 (OneDrive 직접 다운로드용)
        const excelUrl = "https://onedrive.live.com/download?resid=6DC17DD437B292AF!205844&authkey=!AAL-v6OYWyn-ER4";

        async function init() {
            try {
                const res = await fetch(excelUrl);
                const text = await res.text();
                const rows = text.split('\n').slice(1);
                const layers = { "B2":[], "1F":[], "5F":[] };

                rows.forEach(row => {
                    const cols = row.split(',').map(c => c.trim().replace(/"/g, ''));
                    if(cols.length < 5) return;
                    
                    const [floor, space, name, start, end, img] = cols;
                    const today = new Date(); today.setHours(0,0,0,0);
                    const sDate = new Date(start);
                    const eDate = new Date(end);

                    let status = "종료됨";
                    if (today < sDate) status = "오픈 예정";
                    else if (today <= eDate) status = "진행 중";

                    if(layers[floor]) layers[floor].push({ space, name, period: `${start}~${end}`, status, img });
                });

                render(layers);
            } catch (e) {
                document.getElementById('loading').innerHTML = "데이터 연결 실패<br><span class='text-xs'>엑셀 열 순서: 층,공간,이름,시작일,종료일,이미지</span>";
            }
        }

        function render(layers) {
            const app = document.getElementById('app'); app.innerHTML = '';
            Object.keys(layers).forEach(floor => {
                if(layers[floor].length === 0) return;
                const sec = document.createElement('section');
                sec.id = floor;
                sec.innerHTML = `<h2 class="text-3xl font-black mb-4 px-2">${floor}</h2>
                    <div class="carousel px-2">
                        ${layers[floor].map(item => `
                            <div class="card border border-gray-100">
                                <img src="${item.img || 'https://via.placeholder.com/400x500'}" class="w-full h-80 object-cover">
                                <div class="p-4">
                                    <span
